<div class="signin">
  <div class="col-md-4 col-md-offset-4">
    <div id="signin-pannel" class="signin-pannel">
      <div class="form-group form-group-lg">
        <input class='form-control' id='name' name='name' size='30' type='text' v-model="username" placeholder="your name"/>
      </div>
      <div class='form-group form-group-lg'>
        <input class='form-control' id='pass' name='pass' size='30' type='password' v-model="password" placeholder="password"/>
      </div>
      <input type='hidden' name='_csrf' value='<%= csrf %>'/>
      <div class="alert alert-danger" role="alert" v-if="errorMsg">{{errorMsg}}</div>
      <button class='btn btn-primary btn-lg btn-block' v-on:click="submit">登录</button>
      <button class="btn btn-link" href="/auth/github">通过 GitHub 登录</button>
      <button class="btn btn-link" href='/search_pass'>忘记密码了?</button>
    </div>
  </div>
</div>
<script>

var vue = new Vue({
  el: '#signin-pannel',
  data: {
    username: '',
    password: '',
    errorMsg: ''
  },
  methods: {
    submit: function(event) {
      $.post('/signin', { _csrf: $('#_csrf').val(), name: this.username, pass: this.password }, function (result) {
        if (!result.success) {
          vue.errorMsg = result.error;
        } else {
          location.href = '/';
        }
      });
    }
  }
});

</script>