<div class='signup'>
  <div class="col-md-4 col-md-offset-4">
    <div id="signin-pannel" class="signin-pannel">
      <div class='form-group form-group-lg'>
        <input class='form-control' v-model='username' size='30' type='text' value='' placeholder="username"/>
      </div>

      <div class='form-group form-group-lg'>
        <input class='form-control' v-model='pass' size='30' type='password' placeholder="password"/>
      </div>


      <div class='form-group form-group-lg'>
        <input class='form-control' v-model='re_pass' size='30' type='password' placeholder="password again"/>
      </div>


      <div class='form-group form-group-lg'>
        <input class='form-control' v-model='email' size='30' type='text' placeholder="email address"/>
      </div>
      <input type='hidden' name='_csrf' value='<%= csrf %>'/>
      <div class="alert alert-danger" role="alert" v-if="errorMsg">{{errorMsg}}</div>
      <button class='btn btn-primary btn-lg btn-block' v-on:click="submit">注册</button>
      <button class="btn btn-link" href="/auth/github">通过 GitHub 登录</button>
    </div>
  </div>
</div>
<script>

  var vue = new Vue({
    el: '#signin-pannel',
    data: {
      username: '',
      pass: '',
      re_pass: '',
      email: '',
      errorMsg: '',
      successMsg: ''
    },
    methods: {
      submit: function(event) {
        $.post('/signup', { _csrf: $('#_csrf').val(), loginname: this.username, pass: this.pass, re_pass: this.re_pass, email: this.email }, function (result) {
          if (!result.success) {
            vue.errorMsg = result.error;
          } else {
            location.href = '/signin';
          }
        });
      }
    }
  });

</script>
